<!DOCTYPE html>
<!-- (C)edwin@datux.nl - released under GPL --> 
<html> 
	
<head> 
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"> 
	<title>Datux ticket tracking and invoice</title> 

	<link href="css/redmond/jquery-ui.css" rel="stylesheet" type="text/css"/>
	<script type="text/javascript" src="lib/jquery.js"></script>
	<script type="text/javascript" src="lib/jquery-migrate.js"></script>
	<script type="text/javascript" src="lib/jquery-ui.js"></script>
	<script type="text/javascript" src="lib/json2.js"></script>
	<script type="text/javascript" src="lib/jquery.cooquery.js"></script>
	<script type="text/javascript" src="lib/jquery.url.js"></script>
	<script type="text/javascript" src="lib/jquery.history.js"></script>
	<script type="text/javascript" src="lib/jQuery-Timepicker-Addon/jquery-ui-timepicker-addon.js"></script>
	<script type="text/javascript" src="lib/rison.js"></script>
	<script type="text/javascript" src="lib/lodash.js"></script>
	<script type="text/javascript" src="lib/jstorage.js"></script>
	<script type="text/javascript" src="common.js"></script>
	<script type="text/javascript" src="rpc.js"></script>
    <script type="text/javascript" src="fields.js"></script>
    <script type="text/javascript" src="view.js"></script>
    <script type="text/javascript" src="controls.js"></script>
	<script type="text/javascript" src="publish-subscribe.js"></script>
	<link href="lib/jQuery-Timepicker-Addon/jquery-ui-timepicker-addon.css" rel="stylesheet" type="text/css"/>
	<link href="default.css" rel="stylesheet" type="text/css"/>
	<link href="views/view.css" rel="stylesheet" type="text/css"/>

<!--	<script type="text/javascript"
	src="http://jqueryui.com/themeroller/themeswitchertool/">
	</script>
-->

	<script>
		//this is the only global variable that the main-application has to deal with. 
		//usually when creating controls that need to know the user_id or group_ids of the logged in user
		var session={};

		$(document).ready(function()
		{
			//menuReload();
			viewLoad({
				name: 'webui.Menu.main',
				mode: 'existing',
				id: 'viewMenu'				
			});
			
//			$("#themeswitcher").themeswitcher();
			$("#viewLog").click(function(){
				$(this).empty();
			});

			//this event is send by core when session is changed or send_session is called
			$("#login").subscribe("core.Users.changed_session", "login", function(result)
			{
				if (result.user_id)
				{
					$(".login-user").text(result.name);
					$(".on-click-login").hide();
					$(".on-click-logout").show();
				}
				else
				{
					$(".login-user").text("(not logged in)");
					$(".on-click-login").show();
					$(".on-click-logout").hide();
				}
				session=result;
				$.publish("menu.reload", {});
			});

			$(".on-click-logout").click(function(event)
			{
			    viewCreate({
			    },{
			    	params: {},
			    	name: 'core.Users.logout',
			    	mode: 'popup'
			    });
			    return(false);
			});

			$(".on-click-login").click(function(event)
			{
			    viewCreate({
			    },{
			    	params: {},
			    	name: 'core.Users.login',
			    	mode: 'popup'
			    });
			    return(false);
			});

			//determine initial session status
			rpc("core.Users.send_session",{}, function(){;});


		});
	</script>

</head> 
<body class='ui-widget' style='
	font-size:12px;
'> 


<div id='views' class='ui-widget'>
</div>


<div id='viewPath' class='hide-while-printing' style='
	position:fixed;
	top:0em;
	left:15em;
	right:0em;
	min-height: 1em;
	padding-left:1em;
	padding-bottom:0.5em;
	background:#dddddd;
	border-width:2px;
	border-bottom-color:black;
	border-bottom-style:solid;
'>
</div>


<div id='login' class='hide-while-printing' style='
	position:fixed;
	top:0em;
	right:1em;
'>
	<span class='login-user'></span>
	<a href='#' class='on-click-login hide'>Login</a>
	<a href='#' class='on-click-logout hide'>Logout</a>
</div>


<div class='hide-while-printing' style='
	position: fixed;
	top:0em;
	left: 0em;
	bottom:0em;
	width:15em;
	background: #eeeeee;
	border-right-width:2px;
	border-right-style:solid;
	padding-top:4em;
'>
	<div id='viewMenu'>
	</div>
	
	<div id='viewLog' style='
		position:absolute;
		bottom:1em;
	'>
	</div>
</div>



<div id='viewDebug' class='hide-while-printing' style='
	position:fixed;
	right:0em;
	top:0em;
	background-color: #ffffff;
	border-style: solid;
	border-width: 2px;
	border-color: red;
'>
</div>

<img src='icons/logo.png' class='hide-while-printing' style='
	position:fixed;
	top:0em;
	left:0em;
'>

<div class='viewLoading' class='hide-while-printing' style='
	position:fixed;
	left:1em;
	top:2em;
	padding-left:1em;
	padding-right:1em;
	color: #666666;
'>
	processing...
</div>


</body> 
</html> 
 
